import { LinearScale } from '.';

width := 480;
height := 480;

dataset iris: SELECT * FROM read_csv('avenger-runtime/tests/data/iris.csv');

comp x_scale: LinearScale {
    domain := (SELECT [min("SepalLengthCm"), max("SepalLengthCm")] FROM @iris);
    nice := 5;
    range := [40, 440];
    domain_expr:="SepalLengthCm";
}

comp y_scale: LinearScale {
    domain := (SELECT [min("SepalWidthCm"), max("SepalWidthCm")] FROM @iris);
    nice := 5;
    range := [440, 40];
}

Rect {
    x := (@x_scale.range)[1];
    y := (@y_scale.range)[1];
    x2 := (@x_scale.range)[2];
    y2 := (@y_scale.range)[2];
    stroke := 'black';
    stroke_width := 0.2;
}

Symbol {
    data := select * from @iris;
    fill := 'black';
    x := @x_scale(domain_expr:="SepalLengthCm").range_expr;
    y := @y_scale(domain_expr:="SepalWidthCm").range_expr;
}

Text {
    x := 40;
    y := 30;
    val incr: @y_scale.final_domain;
    text := CASE WHEN @incr is not null THEN CAST(@incr AS STRING) ELSE 'NULL' END;
}
